"use strict";function errorAlert(e){alert(e)}function tipsAlert(e){alert(e)}var appState={router:null,isLogin:!0},domain="/api";window.location.href.indexOf("192.168")===-1&&window.location.href.indexOf(":900")===-1&&window.location.href.indexOf("localhost")===-1||(domain="http://"+window.location.hostname+":7999");var makeGet=function(e){return function(o,t){$.get(domain+e,o).done(function(e){paseJson(e,t)}).fail(function(e){errorAlert(e)})}},makePost=function(e){return function(o,t){$.post(domain+e,o).done(function(e){paseJson(e,t)}).fail(function(e){errorAlert(e)})}},paseJson=function(e,o){return"string"==typeof e&&(e=JSON.parse(e)),1!=e.code?errorAlert("服务器出错"+e.msg):void o(e.data)},apiForLogin=makePost("/login"),apiForMemeberIndex=makeGet("/memeber"),loginView=Vue.extend({template:$("#login-template").html(),mounted:function(){$("body").addClass("login-bg")},destoryed:function(){$("body").removeClass("login-bg")},data:function(){return{username:"",password:""}},methods:{login:function(){return this.username?this.password?void apiForLogin({username:this.username,password:this.password},function(e){appState.isLogin=!0,appState.router.push("/staff")}):tipsAlert("密码不能为空"):tipsAlert("用户名不能为空")}}});Vue.component("login-view",loginView);var staffView=Vue.extend({template:$("#staff-template").html(),data:function(){return{username:"",password:""}},methods:{}});Vue.component("staff-view",loginView),console.log("'Allo 'Allo!");var routes=[{path:"/login",component:loginView},{path:"/staff",component:staffView}],router=new VueRouter({routes:routes});router.beforeEach(function(e,o,t){"/login"===o.path&&$("body").removeClass("login-bg"),"/login"===e.path&&$("body").addClass("login-bg"),t()}),appState.router=router;var app=new Vue({router:router}).$mount("#app-start");appState.isLogin?router.push("/staff"):router.push("/login");