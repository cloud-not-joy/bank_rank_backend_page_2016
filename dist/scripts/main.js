"use strict";function errorAlert(e){alert(e)}function tipsAlert(e){alert(e)}var appState={router:null,isLogin:!0},domain="/api";window.location.href.indexOf("192.168")===-1&&window.location.href.indexOf(":900")===-1&&window.location.href.indexOf("localhost")===-1||(domain="http://"+window.location.hostname+":7999");var makeGet=function(e){return function(t,n){$.get(domain+e,t).done(function(e){paseJson(e,n)}).fail(function(e){errorAlert(e)})}},makePost=function(e){return function(t,n){$.post(domain+e,t).done(function(e){paseJson(e,n)}).fail(function(e){errorAlert(e)})}},paseJson=function(e,t){return"string"==typeof e&&(e=JSON.parse(e)),1!=e.code?errorAlert("服务器出错"+e.msg):void t(e.data)},apiForLogin=makePost("/login"),apiForMemeberIndex=makeGet("/memeber"),loginView=Vue.extend({template:$("#login-template").html(),mounted:function(){$("body").addClass("login-bg")},destoryed:function(){$("body").removeClass("login-bg")},data:function(){return{username:"",password:""}},methods:{login:function(){return this.username?this.password?"admin"===this.username?appState.router.push("/admin/staff"):void appState.router.push("/staff"):tipsAlert("密码不能为空"):tipsAlert("用户名不能为空")}}});Vue.component("login-view",loginView);var staffView=Vue.extend({template:$("#staff-template").html(),data:function(){return{currentGoods:{},goodsArray:[]}},mounted:function(){this.goodsArray=[{imgUrl:"http://imgsize.ph.126.net/?imgurl=http://img1.ph.126.net/pKa8Kttj0AsOd7TijP9CRA==/6632036435442880504.jpg_188x188x1.jpg",title:"吹风机一台",rank:400}]},methods:{exchange:function(){$(".exchange-confirm").modal("show")},sureConfirm:function(){$(".exchange-ok").modal("show")},closeConfirm:function(){$(".exchange-modal").modal("hide")},showExchangeHistory:function(){$(".exchange-history").modal("show")}}});Vue.component("staff-view",loginView);var adminView=Vue.extend({template:$("#admin-template").html(),mounted:function(){$(".admin-left-menu").on("click",function(e){$(".admin-left-menu li").removeClass("active"),$(e.target).addClass("active")})},destoryed:function(){},data:function(){return{isActive:""}},methods:{isActiveName:function(e){this.isActive=e}}}),adminStaffView=Vue.extend({template:$("#admin-staff-template").html(),data:function(){return{test:"staff"}},beforeRouteEnter:function(e,t,n){n(function(e){console.log(e.test)})}}),adminGoodsView=Vue.extend({template:$("#admin-goods-template").html(),data:function(){return{}}}),adminSystemView=Vue.extend({template:$("#admin-system-template").html(),data:function(){return{}}});Vue.component("admin-view",adminView),Vue.component("admin-staff",adminStaffView),Vue.component("admin-goods",adminGoodsView),Vue.component("admin-system",adminStaffView),console.log("'Allo 'Allo!");var routes=[{path:"/login",component:loginView},{path:"/staff",component:staffView},{path:"/admin",component:adminView,children:[{path:"staff",component:adminStaffView},{path:"goods",component:adminGoodsView},{path:"system",component:adminSystemView}]}],router=new VueRouter({routes:routes});router.beforeEach(function(e,t,n){"/login"===t.path&&$("body").removeClass("login-bg"),"/login"===e.path&&$("body").addClass("login-bg"),n()}),appState.router=router;var app=new Vue({router:router}).$mount("#app-start");router.push("/login");